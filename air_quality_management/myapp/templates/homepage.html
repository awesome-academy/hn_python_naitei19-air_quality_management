{% extends "base.html" %}
{% load i18n %}

{% block title %}{% trans "Homepage - Air Quality Data" %}{% endblock %}

{% block content %}
    <div class="container-1">
        <h1 style="color: white; padding: 0 0 20px 0;">{% trans "AIR QUALITY MANAGEMENT FOR CITIES" %}</h1>
        <input type="text" id="searchInput" placeholder="{% trans 'Search for locations...' %}">
        <table>
            <thead>
                <tr >
                    <th>{% trans "Location" %}</th>
                    <th>{% trans "Air Quality Index" %}</th>
                    <th>{% trans "Timestamp" %}</th>
                    <th>{% trans "Main Pollutant" %}</th>
                    <th>{% trans "Pollution Level" %}</th>
                    <th>{% trans "Details" %}</th>
                </tr>
            </thead>
            <tbody>
                {% for entry in data %}
                    <tr>
                        <td>{{ entry.location_id }}</td>
                        <td>{{ entry.air_quality_index }}</td>
                        <td>{{ entry.timestamp }}</td>
                        <td></td>
                        <td>{{ entry.pol_level }}</td>
                        <td><a href="{% url 'city_details' location_id=entry.location_id.id %}">{% trans "View Details" %}</a></td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    
    <script>
        var searchInput = document.getElementById('searchInput');
        searchInput.addEventListener('input', function() {
          // Filter the table based on the search input value
          var tableRows = document.querySelector('table tbody').querySelectorAll('tr');
          for (var i = 0; i < tableRows.length; i++) {
            var row = tableRows[i];
            if (!row.textContent.toLowerCase().includes(searchInput.value.toLowerCase())) {
              row.style.display = 'none';
            } else {
              row.style.display = '';
            }
          }
        });
      </script>
{% endblock %}
